// SPDX-License-Identifier: MIT

pragma solidity ^0.8.18;

import {Test, console} from "forge-std/Test.sol";
import {MoodNFT} from "../../src/MoodNFT.sol";
import {DeployMoodNFT} from "../../script/DeployMoodNFT.s.sol";

contract MoodNftIntegration is Test {
    MoodNFT moodNFT;
    DeployMoodNFT deployer;
    address USER = makeAddr("USER");
    string constant SAD_TOKEN_URI =
        "data:application/json;base64,eyJuYW1lIjogIk1vb2QgTkZUIiwgImRlc2NyaXB0aW9uIjogIkFuIE5GVCB0aGF0IHJlZmxlY3RzIHRoZSBtb29kIG9mIGl0cyBvd25lciEiLCAiYXR0cmlidXRlcyI6IFt7InRyYWl0X3R5cGUiOiAibW9vZGluZXNzIiwgInZhbHVlIjogMTAwfV0sICJpbWFnZSI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSFpsY25OcGIyNDlJakV1TVNJZ2VHMXNibk02ZUd4cGJtczlJbWgwZEhBNkx5OTNkM2N1ZHpNdWIzSm5MekU1T1RrdmVHeHBibXNpSUhodGJHNXpPbk4yWjJwelBTSm9kSFJ3T2k4dmMzWm5hbk11WkdWMkwzTjJaMnB6SWlCMmFXVjNRbTk0UFNJd0lEQWdPREF3SURnd01DSStQR1JsWm5NK1BISmhaR2xoYkVkeVlXUnBaVzUwSUdsa1BTSmpZMk5zWVhsdGIycHBMV2R5WVdRdFpHRnlheUlnY2owaU9UTWxJaUJqZUQwaU1qQWxJaUJqZVQwaU1qQWxJajRLSUNBZ0lDQWdQSE4wYjNBZ2IyWm1jMlYwUFNJM01DVWlJSE4wYjNBdFkyOXNiM0k5SW1oemJDZ3pOVEVzSURFd01DVXNJRFkzSlNraUlITjBiM0F0YjNCaFkybDBlVDBpTUNJK1BDOXpkRzl3UGdvZ0lDQWdJQ0E4YzNSdmNDQnZabVp6WlhROUlqazNKU0lnYzNSdmNDMWpiMnh2Y2owaUkyTTJNVGswTlNJZ2MzUnZjQzF2Y0dGamFYUjVQU0l4SWo0OEwzTjBiM0ErQ2lBZ0lDQThMM0poWkdsaGJFZHlZV1JwWlc1MFBqeHlZV1JwWVd4SGNtRmthV1Z1ZENCcFpEMGlZMk5qYkdGNWJXOXFhUzFuY21Ga0xXeHBaMmgwSWlCeVBTSTJOU1VpSUdONFBTSXlPQ1VpSUdONVBTSXlNQ1VpUGdvZ0lDQWdQSE4wYjNBZ2IyWm1jMlYwUFNJd0pTSWdjM1J2Y0MxamIyeHZjajBpSTJabU9HSTVaU0lnYzNSdmNDMXZjR0ZqYVhSNVBTSXdMamMxSWo0OEwzTjBiM0ErQ2lBZ0lDQThjM1J2Y0NCdlptWnpaWFE5SWpFd01DVWlJSE4wYjNBdFkyOXNiM0k5SW1oemJDZ3pOVEVzSURFd01DVXNJRFkzSlNraUlITjBiM0F0YjNCaFkybDBlVDBpTUNJK1BDOXpkRzl3UGdvZ0lEd3ZjbUZrYVdGc1IzSmhaR2xsYm5RK1BHWnBiSFJsY2lCcFpEMGlZMk5qYkdGNWJXOXFhUzFpYkhWeUlpQjRQU0l0TVRBd0pTSWdlVDBpTFRFd01DVWlJSGRwWkhSb1BTSTBNREFsSWlCb1pXbG5hSFE5SWpRd01DVWlJR1pwYkhSbGNsVnVhWFJ6UFNKdlltcGxZM1JDYjNWdVpHbHVaMEp2ZUNJZ2NISnBiV2wwYVhabFZXNXBkSE05SW5WelpYSlRjR0ZqWlU5dVZYTmxJaUJqYjJ4dmNpMXBiblJsY25CdmJHRjBhVzl1TFdacGJIUmxjbk05SW5OU1IwSWlQZ29KUEdabFIyRjFjM05wWVc1Q2JIVnlJSE4wWkVSbGRtbGhkR2x2YmowaU16QWlJSGc5SWpBbElpQjVQU0l3SlNJZ2QybGtkR2c5SWpFd01DVWlJR2hsYVdkb2REMGlNVEF3SlNJZ2FXNDlJbE52ZFhKalpVZHlZWEJvYVdNaUlHVmtaMlZOYjJSbFBTSnViMjVsSWlCeVpYTjFiSFE5SW1Kc2RYSWlQand2Wm1WSFlYVnpjMmxoYmtKc2RYSStQQzltYVd4MFpYSStQR1pwYkhSbGNpQnBaRDBpYVc1dVpYSXRZbXgxY2lJZ2VEMGlMVEV3TUNVaUlIazlJaTB4TURBbElpQjNhV1IwYUQwaU5EQXdKU0lnYUdWcFoyaDBQU0kwTURBbElpQm1hV3gwWlhKVmJtbDBjejBpYjJKcVpXTjBRbTkxYm1ScGJtZENiM2dpSUhCeWFXMXBkR2wyWlZWdWFYUnpQU0oxYzJWeVUzQmhZMlZQYmxWelpTSWdZMjlzYjNJdGFXNTBaWEp3YjJ4aGRHbHZiaTFtYVd4MFpYSnpQU0p6VWtkQ0lqNEtDVHhtWlVkaGRYTnphV0Z1UW14MWNpQnpkR1JFWlhacFlYUnBiMjQ5SWpJaUlIZzlJakFsSWlCNVBTSXdKU0lnZDJsa2RHZzlJakV3TUNVaUlHaGxhV2RvZEQwaU1UQXdKU0lnYVc0OUlsTnZkWEpqWlVkeVlYQm9hV01pSUdWa1oyVk5iMlJsUFNKdWIyNWxJaUJ5WlhOMWJIUTlJbUpzZFhJaVBqd3ZabVZIWVhWemMybGhia0pzZFhJK1BDOW1hV3gwWlhJK1BHWnBiSFJsY2lCcFpEMGlaWGxsTFhOb1lXUnZkeUlnZUQwaUxURXdNQ1VpSUhrOUlpMHhNREFsSWlCM2FXUjBhRDBpTkRBd0pTSWdhR1ZwWjJoMFBTSTBNREFsSWlCbWFXeDBaWEpWYm1sMGN6MGliMkpxWldOMFFtOTFibVJwYm1kQ2IzZ2lJSEJ5YVcxcGRHbDJaVlZ1YVhSelBTSjFjMlZ5VTNCaFkyVlBibFZ6WlNJZ1kyOXNiM0l0YVc1MFpYSndiMnhoZEdsdmJpMW1hV3gwWlhKelBTSnpVa2RDSWo0S0NUeG1aVVJ5YjNCVGFHRmtiM2NnYzNSa1JHVjJhV0YwYVc5dVBTSXhNQ0lnWkhnOUlqRXdJaUJrZVQwaU1UQWlJR1pzYjI5a0xXTnZiRzl5UFNJak1EQXdNREF3SWlCbWJHOXZaQzF2Y0dGamFYUjVQU0l3TGpJaUlIZzlJakFsSWlCNVBTSXdKU0lnZDJsa2RHZzlJakV3TUNVaUlHaGxhV2RvZEQwaU1UQXdKU0lnY21WemRXeDBQU0prY205d1UyaGhaRzkzSWo0OEwyWmxSSEp2Y0ZOb1lXUnZkejRLUEM5bWFXeDBaWEkrUEd4cGJtVmhja2R5WVdScFpXNTBJR2xrUFNKbGVXVXRiR2xuYUhRaUlIZ3hQU0kxTUNVaUlIa3hQU0l3SlNJZ2VESTlJalV3SlNJZ2VUSTlJakV3TUNVaVBnb2dJQ0FnSUNBOGMzUnZjQ0J2Wm1aelpYUTlJakFsSWlCemRHOXdMV052Ykc5eVBTSWpOVFUxTlRVMUlpQnpkRzl3TFc5d1lXTnBkSGs5SWpFaVBqd3ZjM1J2Y0Q0S0lDQWdJQ0FnUEhOMGIzQWdiMlptYzJWMFBTSXhNREFsSWlCemRHOXdMV052Ykc5eVBTSm9jMnhoS0RBc0lEQWxMQ0F3SlN3Z01TNHdNQ2tpSUhOMGIzQXRiM0JoWTJsMGVUMGlNQ0krUEM5emRHOXdQZ29nSUNBZ1BDOXNhVzVsWVhKSGNtRmthV1Z1ZEQ0OGJHbHVaV0Z5UjNKaFpHbGxiblFnYVdROUltMXZkWFJvTFd4cFoyaDBJaUI0TVQwaU5UQWxJaUI1TVQwaU1DVWlJSGd5UFNJMU1DVWlJSGt5UFNJeE1EQWxJajRLSUNBZ0lEeHpkRzl3SUc5bVpuTmxkRDBpTUNVaUlITjBiM0F0WTI5c2IzSTlJaU5tWm1abU9UTWlJSE4wYjNBdGIzQmhZMmwwZVQwaU1TSStQQzl6ZEc5d1Bnb2dJQ0FnUEhOMGIzQWdiMlptYzJWMFBTSXhNREFsSWlCemRHOXdMV052Ykc5eVBTSm9jMnhoS0RVMUxDQTVOQ1VzSURVMEpTd2dNUzR3TUNraUlITjBiM0F0YjNCaFkybDBlVDBpTUNJK1BDOXpkRzl3UGdvZ0lEd3ZiR2x1WldGeVIzSmhaR2xsYm5RK1BHWnBiSFJsY2lCcFpEMGliVzkxZEdndGMyaGhaRzkzSWlCNFBTSXRNVEF3SlNJZ2VUMGlMVEV3TUNVaUlIZHBaSFJvUFNJME1EQWxJaUJvWldsbmFIUTlJalF3TUNVaUlHWnBiSFJsY2xWdWFYUnpQU0p2WW1wbFkzUkNiM1Z1WkdsdVowSnZlQ0lnY0hKcGJXbDBhWFpsVlc1cGRITTlJblZ6WlhKVGNHRmpaVTl1VlhObElpQmpiMnh2Y2kxcGJuUmxjbkJ2YkdGMGFXOXVMV1pwYkhSbGNuTTlJbk5TUjBJaVBnb0pQR1psUkhKdmNGTm9ZV1J2ZHlCemRHUkVaWFpwWVhScGIyNDlJakV3SWlCa2VEMGlNVEFpSUdSNVBTSXhNQ0lnWm14dmIyUXRZMjlzYjNJOUlpTmpNV0kwTURBaUlHWnNiMjlrTFc5d1lXTnBkSGs5SWpBdU1pSWdlRDBpTUNVaUlIazlJakFsSWlCM2FXUjBhRDBpTVRBd0pTSWdhR1ZwWjJoMFBTSXhNREFsSWlCeVpYTjFiSFE5SW1SeWIzQlRhR0ZrYjNjaVBqd3ZabVZFY205d1UyaGhaRzkzUGdvOEwyWnBiSFJsY2o0OEwyUmxabk0rUEdjZ2MzUnliMnRsTFd4cGJtVmpZWEE5SW5KdmRXNWtJajQ4Y0dGMGFDQmtQU0pOTmpneUlEUTBPUzQ1T1RrNU9EVXlOelU0T0RVMU5FTTJPRElnTmpJeUxqVXpOamcxT0RVNU1USTBPVFVnTlRjeUxqVXpOamczTXpNeE5UTTJNemtnTnpZeUxqUXdOREk1TnprME5ETTBPVElnTkRBd0lEYzJNaTQwTURReU9UYzVORFF6TkRreVF6SXlOeTQwTmpNNE9EWTNPVEkwTlRJNE15QTNOakl1TkRBME1qazNPVFEwTXpRNU1pQXhNVGdnTmpJeUxqVXpOamcxT0RVNU1USTBPVFVnTVRFNElEUTBPUzQ1T1RrNU9EVXlOelU0T0RVMU5FTXhNVGdnTWpjM0xqUTJNemczTWpBMk9ETXpPRE16SURJeU55NDBOak00T0RZM09USTBOVEk0TXlBeE16Y3VOVGsxTmpjeU5qQTNOREl4T0RnZ05EQXdJREV6Tnk0MU9UVTJOekkyTURjME1qRTRPRU0xTnpJdU5UTTJPRGN6TXpFMU16WXpPU0F4TXpjdU5UazFOamN5TmpBM05ESXhPRGdnTmpneUlESTNOeTQwTmpNNE56SXdOamd6TXpnek15QTJPRElnTkRRNUxqazVPVGs0TlRJM05UZzROVFUwV2lBaUlHWnBiR3c5SWlOak5qRTVORFVpSUc5d1lXTnBkSGs5SWpBdU1qVWlJR1pwYkhSbGNqMGlkWEpzS0NOalkyTnNZWGx0YjJwcExXSnNkWElwSWo0OEwzQmhkR2crUEhCaGRHZ2daRDBpVFRZNE1pQTBNREF1TURBd01ERXpPREkwTWpBeU1VTTJPRElnTlRneUxqTTJPREEwT0RBeE1qSXpOalFnTlRneUxqTTJPREF6TkRFNE9EQXpORElnTmpZMUxqa3pNVFl6TnpjMU5UZ3lOaUEwTURBZ05qWTFMamt6TVRZek56YzFOVGd5TmtNeU1UY3VOak15TnpZNU1qTXdOelk1TWlBMk5qVXVPVE14TmpNM056VTFPREkySURFeE9DQTFPREl1TXpZNE1EUTRNREV5TWpNMk5DQXhNVGdnTkRBd0xqQXdNREF4TXpneU5ESXdNakZETVRFNElESXhOeTQyTXpJM09ETXdOVFE1TnpFeklESXhOeTQyTXpJM05qa3lNekEzTmpreUlERXpOQzR3Tmpnek9EazRPVEkxTnpneE1pQTBNREFnTVRNMExqQTJPRE00T1RnNU1qVTNPREV5UXpVNE1pNHpOamd3TXpReE9EZ3dNelF5SURFek5DNHdOamd6T0RrNE9USTFOemd4TWlBMk9ESWdNakUzTGpZek1qYzRNekExTkRrM01UTWdOamd5SURRd01DNHdNREF3TVRNNE1qUXlNREl4V2lBaUlHWnBiR3c5SW1oemJDZ3pOVEVzSURFd01DVXNJRFkzSlNraVBqd3ZjR0YwYUQ0OGNHRjBhQ0JrUFNKTk5qZ3lJRFF3TUM0d01EQXdNVE00TWpReU1ESXhRelk0TWlBMU9ESXVNelk0TURRNE1ERXlNak0yTkNBMU9ESXVNelk0TURNME1UZzRNRE0wTWlBMk5qVXVPVE14TmpNM056VTFPREkySURRd01DQTJOalV1T1RNeE5qTTNOelUxT0RJMlF6SXhOeTQyTXpJM05qa3lNekEzTmpreUlEWTJOUzQ1TXpFMk16YzNOVFU0TWpZZ01URTRJRFU0TWk0ek5qZ3dORGd3TVRJeU16WTBJREV4T0NBME1EQXVNREF3TURFek9ESTBNakF5TVVNeE1UZ2dNakUzTGpZek1qYzRNekExTkRrM01UTWdNakUzTGpZek1qYzJPVEl6TURjMk9USWdNVE0wTGpBMk9ETTRPVGc1TWpVM09ERXlJRFF3TUNBeE16UXVNRFk0TXpnNU9Ea3lOVGM0TVRKRE5UZ3lMak0yT0RBek5ERTRPREF6TkRJZ01UTTBMakEyT0RNNE9UZzVNalUzT0RFeUlEWTRNaUF5TVRjdU5qTXlOemd6TURVME9UY3hNeUEyT0RJZ05EQXdMakF3TURBeE16Z3lOREl3TWpGYUlDSWdabWxzYkQwaWRYSnNLQ05qWTJOc1lYbHRiMnBwTFdkeVlXUXRaR0Z5YXlraVBqd3ZjR0YwYUQ0OGNHRjBhQ0JrUFNKTk5qZ3lJRFF3TUM0d01EQXdNVE00TWpReU1ESXhRelk0TWlBMU9ESXVNelk0TURRNE1ERXlNak0yTkNBMU9ESXVNelk0TURNME1UZzRNRE0wTWlBMk5qVXVPVE14TmpNM056VTFPREkySURRd01DQTJOalV1T1RNeE5qTTNOelUxT0RJMlF6SXhOeTQyTXpJM05qa3lNekEzTmpreUlEWTJOUzQ1TXpFMk16YzNOVFU0TWpZZ01URTRJRFU0TWk0ek5qZ3dORGd3TVRJeU16WTBJREV4T0NBME1EQXVNREF3TURFek9ESTBNakF5TVVNeE1UZ2dNakUzTGpZek1qYzRNekExTkRrM01UTWdNakUzTGpZek1qYzJPVEl6TURjMk9USWdNVE0wTGpBMk9ETTRPVGc1TWpVM09ERXlJRFF3TUNBeE16UXVNRFk0TXpnNU9Ea3lOVGM0TVRKRE5UZ3lMak0yT0RBek5ERTRPREF6TkRJZ01UTTBMakEyT0RNNE9UZzVNalUzT0RFeUlEWTRNaUF5TVRjdU5qTXlOemd6TURVME9UY3hNeUEyT0RJZ05EQXdMakF3TURBeE16Z3lOREl3TWpGYUlDSWdabWxzYkQwaWRYSnNLQ05qWTJOc1lYbHRiMnBwTFdkeVlXUXRiR2xuYUhRcElqNDhMM0JoZEdnK1BIQmhkR2dnWkQwaVRUUXdNaUF5TmpRdU5WRTBNekFnTXpNd0xqVWdORFUwSURJMk5DNDFJQ0lnYzNSeWIydGxMWGRwWkhSb1BTSXlNU0lnYzNSeWIydGxQU0pvYzJ4aEtEQXNJREFsTENBd0pTd2dNUzR3TUNraUlHWnBiR3c5SW01dmJtVWlJR1pwYkhSbGNqMGlkWEpzS0NObGVXVXRjMmhoWkc5M0tTSStQQzl3WVhSb1BqeHdZWFJvSUdROUlrMDBNRElnTWpZMExqVlJORE13SURNek1DNDFJRFExTkNBeU5qUXVOU0FpSUhOMGNtOXJaUzEzYVdSMGFEMGlOeUlnYzNSeWIydGxQU0oxY213b0kyVjVaUzFzYVdkb2RDa2lJR1pwYkd3OUltNXZibVVpSUdacGJIUmxjajBpZFhKc0tDTnBibTVsY2kxaWJIVnlLU0krUEM5d1lYUm9Qanh3WVhSb0lHUTlJazAwT0RndU5TQXlOakl1TnpWUk5USTVMalVnTXpNeExqYzFJRFUwTXk0MUlESTJNaTQzTlNBaUlITjBjbTlyWlMxM2FXUjBhRDBpTWpFaUlITjBjbTlyWlQwaWFITnNZU2d3TENBd0pTd2dNQ1VzSURFdU1EQXBJaUJtYVd4c1BTSnViMjVsSWlCbWFXeDBaWEk5SW5WeWJDZ2paWGxsTFhOb1lXUnZkeWtpUGp3dmNHRjBhRDQ4Y0dGMGFDQmtQU0pOTkRnNExqVWdNall5TGpjMVVUVXlPUzQxSURNek1TNDNOU0ExTkRNdU5TQXlOakl1TnpVZ0lpQnpkSEp2YTJVdGQybGtkR2c5SWpjaUlITjBjbTlyWlQwaWRYSnNLQ05sZVdVdGJHbG5hSFFwSWlCbWFXeHNQU0p1YjI1bElpQm1hV3gwWlhJOUluVnliQ2dqYVc1dVpYSXRZbXgxY2lraVBqd3ZjR0YwYUQ0OGNHRjBhQ0JrUFNKTk5ESTJMalVnTlRFMlVUUTJOaTQxSURNeE5pQTFOelV1TlNBMU1UWWdJaUJ6ZEhKdmEyVXRkMmxrZEdnOUlqSXhJaUJ6ZEhKdmEyVTlJbWh6YkdFb05UVXNJRGswSlN3Z05UUWxMQ0F4TGpBd0tTSWdabWxzYkQwaWJtOXVaU0lnWm1sc2RHVnlQU0oxY213b0kyMXZkWFJvTFhOb1lXUnZkeWtpUGp3dmNHRjBhRDQ4Y0dGMGFDQmtQU0pOTkRJMkxqVWdOVEUyVVRRMk5pNDFJRE14TmlBMU56VXVOU0ExTVRZZ0lpQnpkSEp2YTJVdGQybGtkR2c5SWpjaUlITjBjbTlyWlQwaWRYSnNLQ050YjNWMGFDMXNhV2RvZENraUlHWnBiR3c5SW01dmJtVWlJR1pwYkhSbGNqMGlkWEpzS0NOcGJtNWxjaTFpYkhWeUtTSStQQzl3WVhSb1Bqd3ZaejQ4TDNOMlp6ND0ifQ==";

    function setUp() public {
        deployer = new DeployMoodNFT();
        moodNFT = deployer.run();
    }

    function testViewTokenURIIntegration() public {
        vm.prank(USER);
        moodNFT.mintNft();
        console.log(moodNFT.tokenURI(0));
    }

    function testFlipTokenToSad() public {
        vm.prank(USER);
        moodNFT.mintNft();

        vm.prank(USER);
        moodNFT.flipMood(0);

        assertEq(
            keccak256(abi.encodePacked(moodNFT.tokenURI(0))),
            keccak256(abi.encodePacked(SAD_TOKEN_URI))
        );
    }
}
